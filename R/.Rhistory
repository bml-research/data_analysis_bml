df %>%
filter(BloodOxygenLevel < 92 | BloodOxygenLevel > 95) %>%
slice_head(n = 6) %>%
formatted_table()
df %>%
arrange(BloodOxygenLevel) %>%
slice_head(n = 6) %>%
formatted_table()
df %>%
arrange(desc(BloodOxygenLevel)) %>%
slice_head(n = 6) %>%
formatted_table()
df %>%
arrange(desc(BloodOxygenLevel)) %>%
slice_head(n = 1) %>%
formatted_table()
df %>%
arrange(Age, BloodOxygenLevel) %>%
slice_head(n = 6) %>%
formatted_table()
df %>%
arrange(Age, desc(BloodOxygenLevel)) %>%
slice_head(n = 6) %>%
formatted_table()
df %>%
select(Age, Smoking_Status, BloodOxygenLevel, HeartRate) %>%
slice_head(n = 6) %>%
formatted_table()
df %>%
select(-BloodOxygenLevel) %>%
slice_head(n = 6) %>%
formatted_table()
formatted_table()
df %>%
select(Age, ends_with("Level")) %>%
slice_head(n = 6) %>%
formatted_table()
summarize(BloodOxygenLevel = mean(BloodOxygenLevel)
df %>%
summarize(BloodOxygenLevel = mean(BloodOxygenLevel))
summary(df$BloodOxygenLevel)
df %>%
summarize(BloodOxygenLevel = mean(BloodOxygenLevel))
df %>%
summarize(BloodOxygenLevel = mean(BloodOxygenLevel)) %>%
formatted_table()
formatted_table()
df %>%
group_by(Smoking_Status) %>%
summarize(Average_BloodOxygenLevel = mean(BloodOxygenLevel)) %>%
formatted_table()
df %>%
group_by(Smoking_Status) %>%
summarize(average_BOL = mean(BloodOxygenLevel), average_BT = mean(BodyTemperature)) %>%
formatted_table()
df %>%
group_by(Smoking_Status) %>%
summarize(average_BOL = mean(BloodOxygenLevel), sd_BOL = sd(BloodOxygenLevel), average_BT = mean(BodyTemperature), sd_BT = sd(BodyTemperature)) %>%
formatted_table()
df %>%
group_by(Smoking_Status) %>%
summarize(average_BOL = round(mean(BloodOxygenLevel), digits = 1),
sd_BOL = round(sd(BloodOxygenLevel), digits = 2),
average_BT = round(mean(BodyTemperature), digits = 1),
sd_BT = round(sd(BodyTemperature), digits = 2)) %>%
formatted_table()
df %>%
group_by(Smoking_Status) %>%
summarize_each(funs(mean, sd, se=sd(.)/sqrt(n()))) %>%
formatted_table()
formatted_table()
df %>%
group_by(Smoking_Status) %>%
summarize_each(funs(mean, sd, se=sd(.)/sqrt(n()))) %>%
select(-Prescription_mean) %>%
formatted_table()
df %>%
select_if(group_by(df, Smoking_Status), is.numeric) %>%
summarize_each(by_smoking_status, funs(mean, sd, se=sd(.)/sqrt(n()))) %>%
formatted_table()
formatted_table()
df %>%
select_if(group_by(df, Smoking_Status), is.numeric) %>%
summarize_each(funs(mean, sd, se=sd(.)/sqrt(n())) %>%
formatted_table()
df %>%
select_if(group_by(df, Smoking_Status), is.numeric) %>%
summarize_each(funs(mean, sd, se=sd(.)/sqrt(n()))) %>%
formatted_table()
df %>%
# 1. Group the data FIRST by the categorical variable
group_by(Smoking_Status) %>%
# 2. Summarize the data, applying functions ACROSS all numeric columns
summarise(
# Use across() to select columns and apply multiple functions
# .cols = where(is.numeric) selects all numeric columns
# .fns = list(...) applies the functions
across(
.cols = where(is.numeric),
.fns = list(
mean = mean,
sd = sd,
se = ~ sd(.) / sqrt(n()) # The tilde (~) creates an anonymous function for SE
)
)
) %>%
# 3. Apply the custom/formatting function
formatted_table()
#df %>%
#  select_if(group_by(df, Smoking_Status), is.numeric) %>%
#  summarize_each(funs(mean, sd, se=sd(.)/sqrt(n()))) %>%
#  formatted_table()
df %>%
# 1. Group the data FIRST by the categorical variable
group_by(Smoking_Status) %>%
# 2. Summarize the data, applying functions ACROSS all numeric columns
summarise(
# Use across() to select columns and apply multiple functions
# .cols = where(is.numeric) selects all numeric columns
# .fns = list(...) applies the functions
across(
.cols = where(is.numeric),
.fns = list(
mean = mean,
sd = sd,
se = ~ sd(.) / sqrt(n()) # The tilde (~) creates an anonymous function for SE
)
)
) %>%
# 3. Apply the custom/formatting function
formatted_table()
df %>%
group_by(Smoking_Status) %>%
summarize(across(everything(), list(mean = mean, sd = sd))) %>%
formatted_table()
df %>%
group_by(Smoking_Status) %>%
summarize_all(list(mean = mean, sd = sd)) %>%
formatted_table()
formatted_table()
df %>%
select_if(~sum(!is.na(.)) > 0) %>%
formatted_table()
df %>%
select_if(~sum(!is.na(.)) > 0) %>%
slice_head(n = 6) %>%
formatted_table()
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(readxl)
file_path <- "./files_07_data_cleaning_exercises/exercise01/Heart_Disease_Prediction.xlsx"
df <- read_excel(file_path)
colname <- "index$Age$Sex$Chest pain type$BP$Cholesterol$FBS over 120$EKG results$Max HR$Exercise angina$ST depression$Slope of ST$Number of vessels fluro$Thallium$Heart Disease"
df <- df %>% separate_wider_delim(colname, delim = "$", names = c("index", "Age", "Sex", "Chest pain type" ,"BP", "Cholesterol", "FBS over 120", "EKG results", "Max HR", "Exercise angina", "ST depression", "Slope of ST", "Number of vessels fluro", "Thallium", "Heart Disease"))
formatted_table(head(df, c(6, 13)))
library(tidyverse)
library(knitr)
library(kableExtra)
library(pillar)
formatted_table <- function(df) {
col_types <- sapply(df, pillar::type_sum)
new_col_names <- paste0(names(df), "<br>", "<span style='font-weight: normal;'>", col_types, "</span>")
kbl(df,
col.names = new_col_names,
escape = FALSE, # This is crucial to allow the <br> tag to work
format = "html" # Ensure HTML format, although often auto-detected
) %>%
kable_styling(bootstrap_options = c("striped", "hover", "responsive"))
}
library(readxl)
file_path <- "./files_07_data_cleaning_exercises/exercise01/Heart_Disease_Prediction.xlsx"
df <- read_excel(file_path)
colname <- "index$Age$Sex$Chest pain type$BP$Cholesterol$FBS over 120$EKG results$Max HR$Exercise angina$ST depression$Slope of ST$Number of vessels fluro$Thallium$Heart Disease"
df <- df %>% separate_wider_delim(colname, delim = "$", names = c("index", "Age", "Sex", "Chest pain type" ,"BP", "Cholesterol", "FBS over 120", "EKG results", "Max HR", "Exercise angina", "ST depression", "Slope of ST", "Number of vessels fluro", "Thallium", "Heart Disease"))
formatted_table(head(df, c(6, 13)))
file_path <- "./files_07_data_cleaning_exercises/exercise02/fish_data_mod.csv"
df <- read_csv2(file_path)
df <- df %>%
separate_wider_delim(average_length, delim = " ", names = c("average_length", "length_unit")) %>%
separate_wider_delim(average_weight, delim = " ", names = c("average_weight", "weight_unit")) %>%
separate_wider_delim(life_span, delim = " ", names = c("life_span", "time_unit")) %>%
select (-c(length_unit, weight_unit, time_unit)) %>% #Note that this is a negative selection. Selects all but the listed columns.
mutate_at(c('average_length', 'average_weight', 'life_span'), as.numeric) #Creates numbers from strings. mutate_at acts on multiple columns
formatted_table(head(df))
file_path <- "./files_07_data_cleaning_exercises/exercise03/Heart_Disease_Prediction_mod.xlsx"
df <- read_excel(file_path)
formatted_table(head(df, c(6, 13)))
df$index[duplicated(df$index)]
df %>%
filter(duplicated(index)) %>%
pull(index)
formatted_table(df[df$index == 8, ])
formatted_table(df[df$index == 10, ])
df %>%
filter(index == 8) %>%
formatted_table()
formatted_table(df[df$index == 8, ])
df %>%
filter(index == 8) %>%
formatted_table()
df %>%
filter(index == 10) %>%
formatted_table()
nrow(df)
my_data_cleaned <- df[!duplicated(df$index), ]
formatted_table(head(my_data_cleaned, c(6,13)))
nrow(my_data_cleaned)
df %>%
# 1. Remove rows with duplicated 'index' values
distinct(index, .keep_all = TRUE) %>%
# 2. Select the first 6 rows
head(6) %>%
# 3. Select the first 13 columns
select(1:13) %>%
# 4. Apply the formatting function
formatted_table()
nrow(my_data_cleaned)
my_data_cleaned <- df %>%
# 1. Remove rows with duplicated 'index' values
distinct(index, .keep_all = TRUE) %>%
# 2. Select the first 6 rows
head(6) %>%
# 3. Select the first 13 columns
select(1:13) %>%
formatted_table(my_data_cleaned)
my_data_cleaned <- df %>%
# 1. Remove rows with duplicated 'index' values
distinct(index, .keep_all = TRUE) %>%
# 2. Select the first 6 rows
head(6) %>%
# 3. Select the first 13 columns
select(1:13)
formatted_table(my_data_cleaned)
nrow(my_data_cleaned)
my_data_cleaned <- df %>%
# 1. Remove rows with duplicated 'index' values
distinct(index, .keep_all = TRUE) %>%
# 3. Select the first 13 columns
select(1:13)
formatted_table(my_data_cleaned)
nrow(my_data_cleaned)
my_data_cleaned <- df %>%
# 1. Remove rows with duplicated 'index' values
distinct(index, .keep_all = TRUE) %>%
# 3. Select the first 13 columns
select(1:13)
formatted_table(head(my_data_cleaned))
nrow(my_data_cleaned)
my_data_cleaned$index[duplicated(my_data_cleaned$index)]
file_path <- "./files_07_data_cleaning_exercises/exercise04/CHEMBL1989.csv"
df <- read_csv(file_path)
formatted_table(head(df, c(6, 5)))
paste("total elements:", nrow(df), "x", ncol(df), "=", nrow(df) * ncol(df))
paste("empty elements:", sum(is.na(df)))
paste("non-empty elements:", sum(!is.na(df)))
file_path <- "./files_07_data_cleaning_exercises/exercise05/CHEMBL1989_mod.csv"
df <- read_csv2(file_path)
df <- df %>%
replace(. == "-", NA)
formatted_table(head(df, c(6, 5)))
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(tidyverse)
library(knitr)
library(kableExtra)
library(pillar)
formatted_table <- function(df) {
col_types <- sapply(df, pillar::type_sum)
new_col_names <- paste0(names(df), "<br>", "<span style='font-weight: normal;'>", col_types, "</span>")
kbl(df,
col.names = new_col_names,
escape = FALSE, # This is crucial to allow the <br> tag to work
format = "html" # Ensure HTML format, although often auto-detected
) %>%
kable_styling(bootstrap_options = c("striped", "hover", "responsive"))
}
file_path <- "./files_10_data_analysis_exercises/exercise01/Data_Cortex_Nuclear.csv"
df <- read_csv(file_path)
formatted_table(head(df))
min_CDK5_N <- min(df$CDK5_N)
max_CDK5_N <- max(df$CDK5_N)
mean_CDK5_N <- mean(df$CDK5_N)
median_CDK5_N <- median(df$CDK5_N)
min_Tau_N <- min(df$Tau_N)
max_Tau_N <- max(df$Tau_N)
mean_Tau_N <- mean(df$Tau_N)
median_Tau_N <- median(df$Tau_N)
results_ex1 <- tibble("measure" = c("minimum", "maximum", "mean", "median"),
"CDK5_N" = c(min_CDK5_N, max_CDK5_N, mean_CDK5_N, median_CDK5_N),
"Tau_N" = c(min_Tau_N, max_Tau_N, mean_Tau_N, median_Tau_N)
)
formatted_table(results_ex1)
formatted_table(filter(df, `Tau_N` == max(df$Tau_N)))
df %>%
filter(`Tau_N` == max(df$Tau_N)) %>%
formatted_table()
max(df$Tau_N)
head(df$Tau_N == max(df$Tau_N)) # Somewhere the value will be TRUE
df[df$Tau_N == max(df$Tau_N), ]
df %>%
slice_max(Tau_N)
min(df$pAKT_N) # check there are NA values in this column
formatted_table(filter(df, `pAKT_N` == min(df$pAKT_N, na.rm = TRUE))) # this will remove all NA values and then show the mouse with minimal value for pAKT
formatted_table(filter(df, `pAKT_N` == min(df$pAKT_N, na.rm = TRUE))) # this will remove all NA values and then show the mouse with minimal value for pAKT
df %>%
slice_max(Tau_N) %>%
formatted_table()
df %>%
slice_min(pAKT_N) %>%
formatted_table()
summary(df$BAD_N)
sum(is.na(df$BAD_N))
formatted_table(head(arrange(df, desc(Genotype), desc(Tau_N))))
df %>%
arrange(desc(Genotype), desc(Tau_N)) %>%
formatted_table()
formatted_table()
df %>%
arrange(desc(Genotype), desc(Tau_N)) %>%
slice_head(n = 6) %>%
formatted_table()
formatted_table(my_answer)
my_answer <- df %>%
filter(Genotype == "Ts65Dn") %>%
filter(Tau_N == max(Tau_N, na.rm = T))
formatted_table(my_answer)
df %>%
arrange(desc(Genotype), desc(Treatment), desc(Tau_N)) %>%
formatted_table()
df %>%
arrange(desc(Genotype), desc(Treatment), desc(Tau_N)) %>%
slice_head(n = 6) %>%
formatted_table()
formatted_table(my_answer)
my_answer <- df %>%
filter(Genotype == "Ts65Dn") %>%
filter(Treatment == "Saline") %>%
filter(Tau_N == max(Tau_N, na.rm = T))
formatted_table(my_answer)
summary(df$DYRK1A_N) # to check whether there NA values in this column
print("Yes, there are 3 NA values in this column!")
sum(df$DYRK1A_N > 0.5, na.rm = TRUE)
nrow(df[df$DYRK1A_N > 0.5, ])
only_nums <- df %>%
select_if(is.numeric) %>% # select only columns with numeric values
colSums(only_nums > 0.5, na.rm = TRUE)
only_nums <- df %>%
select_if(is.numeric) %>% # select only columns with numeric values
colSums(> 0.5, na.rm = TRUE)
only_nums <- df %>%
select_if(is.numeric) # select only columns with numeric values
only_nums <- df %>%
select_if(is.numeric) # select only columns with numeric values
colSums(only_nums > 0.5, na.rm = TRUE)
my_answer <- df %>%
filter(Genotype == "Ts65Dn") %>%
filter(Treatment == "Saline") %>%
filter(Tau_N == max(Tau_N, na.rm = T))
formatted_table(my_answer)
summary(df$DYRK1A_N) # to check whether there NA values in this column
print("Yes, there are 3 NA values in this column!")
sum(df$DYRK1A_N > 0.5, na.rm = TRUE)
nrow(df[df$DYRK1A_N > 0.5, ])
only_nums <- select_if(df, is.numeric) # select only columns with numeric values
colSums(only_nums > 0.5, na.rm = TRUE)
df %>%
summarise(
across(
.cols = where(is.numeric),
.fns = ~ sum(. > 0.5, na.rm = TRUE)
)
)
only_nums <- select_if(df, is.numeric) # select only columns with numeric values
colSums(only_nums > 0.5, na.rm = TRUE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(tidyverse)
library(knitr)
library(kableExtra)
library(pillar)
formatted_table <- function(df) {
col_types <- sapply(df, pillar::type_sum)
new_col_names <- paste0(names(df), "<br>", "<span style='font-weight: normal;'>", col_types, "</span>")
kbl(df,
col.names = new_col_names,
escape = FALSE, # This is crucial to allow the <br> tag to work
format = "html" # Ensure HTML format, although often auto-detected
) %>%
kable_styling(bootstrap_options = c("striped", "hover", "responsive"))
}
file_path <- "./files_10_data_analysis_exercises/exercise01/Data_Cortex_Nuclear.csv"
df <- read_csv(file_path)
formatted_table(head(df))
min_CDK5_N <- min(df$CDK5_N)
max_CDK5_N <- max(df$CDK5_N)
mean_CDK5_N <- mean(df$CDK5_N)
median_CDK5_N <- median(df$CDK5_N)
min_Tau_N <- min(df$Tau_N)
max_Tau_N <- max(df$Tau_N)
mean_Tau_N <- mean(df$Tau_N)
median_Tau_N <- median(df$Tau_N)
results_ex1 <- tibble("measure" = c("minimum", "maximum", "mean", "median"),
"CDK5_N" = c(min_CDK5_N, max_CDK5_N, mean_CDK5_N, median_CDK5_N),
"Tau_N" = c(min_Tau_N, max_Tau_N, mean_Tau_N, median_Tau_N)
)
formatted_table(results_ex1)
df %>%
filter(`Tau_N` == max(df$Tau_N)) %>%
formatted_table()
max(df$Tau_N)
head(df$Tau_N == max(df$Tau_N)) # Somewhere the value will be TRUE
df[df$Tau_N == max(df$Tau_N), ]
df %>%
slice_max(Tau_N) %>%
formatted_table()
formatted_table(filter(df, `pAKT_N` == min(df$pAKT_N, na.rm = TRUE))) # this will remove all NA values and then show the mouse with minimal value for pAKT
df %>%
slice_min(pAKT_N) %>%
formatted_table()
summary(df$BAD_N)
sum(is.na(df$BAD_N))
df %>%
arrange(desc(Genotype), desc(Tau_N)) %>%
slice_head(n = 6) %>%
formatted_table()
my_answer <- df %>%
filter(Genotype == "Ts65Dn") %>%
filter(Tau_N == max(Tau_N, na.rm = T))
formatted_table(my_answer)
df %>%
arrange(desc(Genotype), desc(Treatment), desc(Tau_N)) %>%
slice_head(n = 6) %>%
formatted_table()
my_answer <- df %>%
filter(Genotype == "Ts65Dn") %>%
filter(Treatment == "Saline") %>%
filter(Tau_N == max(Tau_N, na.rm = T))
formatted_table(my_answer)
summary(df$DYRK1A_N) # to check whether there NA values in this column
print("Yes, there are 3 NA values in this column!")
sum(df$DYRK1A_N > 0.5, na.rm = TRUE)
nrow(df[df$DYRK1A_N > 0.5, ])
only_nums <- select_if(df, is.numeric) # select only columns with numeric values
colSums(only_nums > 0.5, na.rm = TRUE)
df %>%
summarise(
across(
.cols = where(is.numeric),
.fns = ~ sum(. > 0.5, na.rm = TRUE)
)
)
sum(df$pELK_N > 0.75 & df$pERK_N > 0.25, na.rm = T)
formatted_table(filter(df, pCASP9_N > 2.3))
df %>%
group_by(MouseID) %>%
filter(n() > 1)
formatted_table(head(select(df, MouseID, APP_N, NR1_N, pCREB_N, S6_N, Genotype)))
formatted_table(head(select(df, -ends_with("_N"))))
proteins <- c("PKCA_N", "RRP1_N", "BRAF_N", "JNK_N") # make a selection of columns to check if there are NA values
summary(df[proteins]) # check the selected columns for NA values
formatted_table(df %>%
group_by(Genotype) %>%
summarize("St.Dev PKCA" = round(sd(PKCA_N, na.rm = T), 3),
"Mean PKCA" = round(mean(PKCA_N, na.rm = T), 3),
"Median PKCA" = round(median(PKCA_N, na.rm = T), 3),
"SD.Dev RRP1" = round(sd(RRP1_N), 3),
"Mean RRP1" = round(mean(RRP1_N, na.rm = T), 3),
"Median RRP1" = round(median(RRP1_N, na.rm = T), 3),
"SD.Dev BRAF" = round(sd(BRAF_N, na.rm = T), 3),
"Mean BRAF" = round(mean(BRAF_N, na.rm = T), 3),
"Median BRAF" = round(median(BRAF_N, na.rm = T), 3),
"SD.Dev JNK" = round(sd(JNK_N, na.rm = T), 3),
"Mean JNK" = round(mean(JNK_N, na.rm = T), 3),
"Median JNK" = round(median(JNK_N, na.rm = T), 3)
))
sum(df$pELK_N > 0.75 & df$pERK_N > 0.25, na.rm = T)
df %>%
filter(pCASP9_N > 2.3) %>%
formatted_table()
df %>%
group_by(MouseID) %>%
filter(n() > 1)
df %>%
select(MouseID, APP_N, NR1_N, pCREB_N, S6_N, Genotype) %>%
formatted_table()
df %>%
select(MouseID, APP_N, NR1_N, pCREB_N, S6_N, Genotype) %>%
slice_head(n = 6) %>%
formatted_table()
df %>%
select(-ends_with("_N"))) %>%
slice_head(n = 6) %>%
formatted_table()
df %>%
select(-ends_with("_N")) %>%
slice_head(n = 6) %>%
formatted_table()
proteins <- c("PKCA_N", "RRP1_N", "BRAF_N", "JNK_N") # make a selection of columns to check if there are NA values
summary(df[proteins]) # check the selected columns for NA values
df %>%
group_by(Genotype) %>%
summarize("St.Dev PKCA" = round(sd(PKCA_N, na.rm = T), 3),
"Mean PKCA" = round(mean(PKCA_N, na.rm = T), 3),
"Median PKCA" = round(median(PKCA_N, na.rm = T), 3),
"SD.Dev RRP1" = round(sd(RRP1_N), 3),
"Mean RRP1" = round(mean(RRP1_N, na.rm = T), 3),
"Median RRP1" = round(median(RRP1_N, na.rm = T), 3),
"SD.Dev BRAF" = round(sd(BRAF_N, na.rm = T), 3),
"Mean BRAF" = round(mean(BRAF_N, na.rm = T), 3),
"Median BRAF" = round(median(BRAF_N, na.rm = T), 3),
"SD.Dev JNK" = round(sd(JNK_N, na.rm = T), 3),
"Mean JNK" = round(mean(JNK_N, na.rm = T), 3),
"Median JNK" = round(median(JNK_N, na.rm = T), 3)
) %>%
formatted_table()
